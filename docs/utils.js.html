<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: utils.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: utils.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// utils.js

// Sample rate is assumed to be constant
const sampleRate = 44100,
  bitDepth = 16 ,
  numChannels = 2 ,
  wavAudioFormat = 1,
  tolerance = 1500;

// Generate rest (silence) data for the specified duration
export function rest(duration) {
  const restData = [];
  const totalSamples = Math.floor(duration * sampleRate);
  for (let i = 0; i &lt; totalSamples; i++) {
    restData.push(0); // Silence
  }
  return restData;
}

// Concatenates an array of note arrays
export function concat(...notes) {
  return notes.flat(); // Flatten all note arrays into one
}

// Calculate frequency from pitch step
export function frequency(step) {
  return 440.0 * Math.pow(2, step / 12.0); // A440 standard
}

// Returns the note data based on frequency, duration, envelope, harmonic, and volume
export function noteData(frequency, duration, envelope, harmonic, volume) {
  const data = [];

  for (let i = 0.0; i &lt; duration; i = i+ (1.0 / (sampleRate))) {

    const x = volume * envelope(i, duration) * harmonic(frequency * i) ;
    //    const amplitude = envelope(time, duration) * harmonic(frequency * i) *volume;

    data.push(x);
  }
  return data;
}

function frequencyScale(step ) {
  return 440.0 * (Math.pow(2, ((step) / 12.0)));
}

function floorTowardsZero(num) {
  console.log(Math.floor(num));
  return Math.floor(num) ;
}
export function noteData2(frequency, duration, envelope, harmonic, volume) {
  let data = [];

  for (let i = 0; i &lt; duration; i += 1.0 / sampleRate) {
    const x = Math.floor(volume * envelope(i, duration) * harmonic(frequency * i));
    data.push(x);
  }

  return data;
}

function sineWaveAt(sampleNumber, tone) {
  var sampleFreq = sampleRate / tone;
  return Math.sin(sampleNumber / (sampleFreq / (Math.PI * 2)));
}

// Returns the note data based on frequency, duration, envelope, harmonic, and volume
/*export function noteData(frequency, duration, envelope, harmonic, volume) {
  const arr = [];

  volume = 0.2;
  const seconds = 0.5;
  const tone = 441;

  for (var i = 0; i &lt; sampleRate * seconds; i++) {
    arr[i] = sineWaveAt(i, tone) * volume
  }
  return arr;
}
*/

// Check if the given note is in the key signature
export function inKey(keys, note) {
  return keys.includes(note);
}

// Check if the note is part of the specified key
export function inNote(notes, note) {
  return notes.includes(note);
}

// utils.js

/**
 * Get the frequency of a note based on its distance from A4 (440 Hz).
 * @param {string} note - The note (e.g., 'C4', 'A4', 'G#5').
 * @returns {number} - The frequency of the note in Hz.
 */
export function calculateFrequency(note) {
  const noteMap = {
    'C': -9, 'C#': -8, 'D': -7, 'D#': -6, 'E': -5,
    'F': -4, 'F#': -3, 'G': -2, 'G#': -1, 'A': 0,
    'A#': 1, 'B': 2
  };

  const noteUpper = note.toUpperCase();
  const parsedNote = noteUpper.match(/^([A-G]#?)(\d)$/);
  if (!parsedNote) throw new Error(`Invalid note format: ${note}`);

  const [, noteName, octave] = parsedNote;
  const semitoneDistance = noteMap[noteName] + (parseInt(octave) - 4) * 12;
  return 440 * Math.pow(2, semitoneDistance / 12); // Frequency calculation
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#calculateFrequency">calculateFrequency</a></li><li><a href="global.html#createNote">createNote</a></li><li><a href="global.html#createSong">createSong</a></li><li><a href="global.html#setDuration">setDuration</a></li><li><a href="global.html#setHarmonic">setHarmonic</a></li><li><a href="global.html#setVolume">setVolume</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.3</a> on Sun Oct 27 2024 21:41:50 GMT+0100 (West Africa Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
